{"version":3,"file":"server.js","mappings":"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","sources":["webpack://chords-vk-app/./src/app.tsx","webpack://chords-vk-app/./src/code/canvas/chord.ts","webpack://chords-vk-app/./src/code/common/alerts.ts","webpack://chords-vk-app/./src/code/common/guid.ts","webpack://chords-vk-app/./src/code/data/guitar-string.ts","webpack://chords-vk-app/./src/code/data/notes.ts","webpack://chords-vk-app/./src/code/firebase/index.ts","webpack://chords-vk-app/./src/components/chords/add-chord/barre/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/drawing-fret/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/guitar-strings/guitar-string.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/guitar-strings/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/instrument/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/name/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/notes/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/save-button/index.tsx","webpack://chords-vk-app/./src/components/chords/add-chord/startFret/index.tsx","webpack://chords-vk-app/./src/components/common/dialogs/snackbar/index.tsx","webpack://chords-vk-app/./src/components/layout/page-layout.tsx","webpack://chords-vk-app/./src/components/navigation/mobile/index.tsx","webpack://chords-vk-app/./src/components/views/add-track.tsx","webpack://chords-vk-app/./src/components/views/admin/add-chords/index.tsx","webpack://chords-vk-app/./src/components/views/admin/index.tsx","webpack://chords-vk-app/./src/components/views/chords.tsx","webpack://chords-vk-app/./src/components/views/favourites.tsx","webpack://chords-vk-app/./src/components/views/tracks.tsx","webpack://chords-vk-app/./src/components/views/view-list.tsx","webpack://chords-vk-app/./src/components/vk/layout/header/heade-and-back/index.tsx","webpack://chords-vk-app/./src/pages.tsx","webpack://chords-vk-app/./src/server.ts","webpack://chords-vk-app/./src/server/auth.ts","webpack://chords-vk-app/./src/server/common.ts","webpack://chords-vk-app/./src/server/database.ts","webpack://chords-vk-app/./src/server/vk.ts","webpack://chords-vk-app/./src/ssr.tsx","webpack://chords-vk-app/./src/stores/add-chords-store.ts","webpack://chords-vk-app/./src/stores/global-store.ts","webpack://chords-vk-app/./src/stores/snackbar.ts","webpack://chords-vk-app/./node_modules/@vkontakte/vkui/dist/vkui.css","webpack://chords-vk-app/external commonjs \"@firebase/firestore\"","webpack://chords-vk-app/external commonjs \"@vkontakte/icons\"","webpack://chords-vk-app/external commonjs \"@vkontakte/vkui\"","webpack://chords-vk-app/external commonjs \"crypto\"","webpack://chords-vk-app/external commonjs \"express\"","webpack://chords-vk-app/external commonjs \"express-useragent\"","webpack://chords-vk-app/external commonjs \"firebase-admin\"","webpack://chords-vk-app/external commonjs \"firebase/app\"","webpack://chords-vk-app/external commonjs \"firebase/database\"","webpack://chords-vk-app/external commonjs \"firebase/firestore\"","webpack://chords-vk-app/external commonjs \"mobx\"","webpack://chords-vk-app/external commonjs \"mobx-react-lite\"","webpack://chords-vk-app/external commonjs \"react\"","webpack://chords-vk-app/external commonjs \"react-dom/server\"","webpack://chords-vk-app/external commonjs \"uuid\"","webpack://chords-vk-app/external node-commonjs \"fs\"","webpack://chords-vk-app/external node-commonjs \"path\"","webpack://chords-vk-app/webpack/bootstrap","webpack://chords-vk-app/webpack/runtime/compat get default export","webpack://chords-vk-app/webpack/runtime/define property getters","webpack://chords-vk-app/webpack/runtime/harmony module decorator","webpack://chords-vk-app/webpack/runtime/hasOwnProperty shorthand","webpack://chords-vk-app/webpack/runtime/make namespace object","webpack://chords-vk-app/webpack/before-startup","webpack://chords-vk-app/webpack/startup","webpack://chords-vk-app/webpack/after-startup"],"sourcesContent":["import React from 'react'\r\nimport ReactDom from 'react-dom'\r\nimport { AppRoot, Panel, View } from '@vkontakte/vkui'\r\nimport { AdaptivityProvider, ConfigProvider } from '@vkontakte/vkui'\r\n\r\ndeclare var window: any\r\n\r\nimport '@vkontakte/vkui/dist/vkui.css'\r\n\r\nimport Layout from './components/layout/page-layout'\r\nimport ViewList from './components/views/view-list'\r\n\r\ntry {\r\n  console.log(window);\r\n} catch (err) {\r\n  global['window'] = { isServer: true };\r\n}\r\n\r\ndeclare global {\r\n  interface Window {\r\n    adminToken: string\r\n    validVk: boolean\r\n    isServer: boolean\r\n  }\r\n}\r\n\r\nconst App: React.FC = () => {\r\n\r\n  return (\r\n    <ConfigProvider>\r\n      <AdaptivityProvider>\r\n        <AppRoot>\r\n          <Layout >\r\n            <ViewList />\r\n          </Layout>\r\n        </AppRoot>\r\n      </AdaptivityProvider>\r\n    </ConfigProvider>\r\n  )\r\n}\r\n\r\nexport default App\r\n","import { iParams as iChordParams } from '../../stores/add-chords-store'\r\n\r\nclass ChordCanvas {\r\n\r\n    canvas: HTMLCanvasElement\r\n    context: CanvasRenderingContext2D\r\n\r\n    params: iChordParams\r\n\r\n    stepStrings: number\r\n    stepFrets: number\r\n    padding: number = 10\r\n    topPadding: number = this.padding * 2\r\n\r\n    stringsColor = 'black'\r\n    fretsColor = '#99a2ad'\r\n\r\n    constructor(canvas: HTMLCanvasElement) {\r\n        this.canvas = canvas\r\n        this.context = this.canvas.getContext('2d')!\r\n    }\r\n\r\n    draw(params: iChordParams, width: number, height: number) {\r\n\r\n        this.params = params\r\n        this.canvas.width = width\r\n        this.canvas.height = height\r\n\r\n        this.clear()\r\n        this.drawEmptyFrets()\r\n    }\r\n\r\n    drawEmptyFrets() {\r\n\r\n        this.context.strokeStyle = this.stringsColor\r\n        this.context.lineWidth = 1\r\n\r\n        this.drawFrets()\r\n        this.drawStrings()\r\n        this.drawChords()\r\n\r\n        this.drawDescription()\r\n    }\r\n\r\n    drawFrets() {\r\n\r\n        let y = this.topPadding\r\n        this.stepFrets = (this.canvas.height - this.padding - y) / 5\r\n\r\n        for(let i = 0; i <= 5; i++) {\r\n            this.drawLine(this.padding, y, this.canvas.width - this.padding, y)\r\n            y += this.stepFrets\r\n        }\r\n    }\r\n\r\n    drawStrings() {\r\n\r\n        let x = this.canvas.width - this.padding\r\n        this.stepStrings = (x - this.padding) / (this.params.guitarStrings.length - 1)\r\n\r\n        this.params.guitarStrings.forEach((string) => {\r\n            this.drawLine(x, this.topPadding, x, this.canvas.height - this.padding)\r\n            x -= this.stepStrings\r\n        })\r\n    }\r\n\r\n    drawChords() {\r\n\r\n        this.context.strokeStyle = this.fretsColor\r\n        this.context.lineWidth = 7\r\n\r\n        this.drawBarre()\r\n        this.drawStringFrets()\r\n    }\r\n\r\n    drawBarre() {\r\n\r\n        if(!this.params.barre) return\r\n\r\n        const strings = this.params.guitarStrings\r\n\r\n        let skipStrings = 0\r\n\r\n        for(let i = strings.length - 1; i >= 0; i--) {\r\n                \r\n            if(strings[i].fret !== 'notPlayed') {\r\n                break\r\n            }\r\n\r\n            skipStrings++\r\n        }\r\n\r\n        const startX = this.padding + (skipStrings * this.stepStrings) - 2\r\n        const endX = this.canvas.width - this.padding + 2\r\n        const y = this.topPadding + (this.stepFrets / 2)\r\n\r\n        this.drawLine(startX, y, endX, y)\r\n    }\r\n\r\n    drawStringFrets() {\r\n\r\n        const strings = this.params.guitarStrings\r\n\r\n        for(let i = strings.length - 1; i >= 0; i--) {\r\n\r\n            const string = strings[i]\r\n\r\n            if(string.fret === 'notPlayed' || string.fret === this.params.startFret) continue\r\n            \r\n            const fert: number = string.fret as number\r\n\r\n            const x = this.canvas.width - this.padding - ((string.index - 1) * this.stepStrings)\r\n            const y = this.topPadding + ((fert - (this.params.startFret + 1)) * this.stepFrets) + (this.stepFrets / 2)\r\n\r\n            this.context.beginPath()\r\n\r\n            this.context.fillStyle = this.fretsColor\r\n            this.context.arc(x, y, 5, 0, Math.PI * 2)\r\n            this.context.fill()\r\n\r\n            this.context.beginPath()\r\n        }\r\n    }\r\n\r\n    drawDescription() {\r\n\r\n        if(this.params.startFret !== 0) {\r\n            this.context.lineWidth = 0.75\r\n            this.context.strokeText(this.params.startFret.toString(), this.padding - 10, (this.topPadding / 2) - 2)\r\n        }\r\n\r\n        for(let i = this.params.guitarStrings.length - 1; i >= 0; i--) {\r\n\r\n            const string = this.params.guitarStrings[i]\r\n\r\n            if(string.fret !== 'notPlayed') continue\r\n\r\n            const x = this.canvas.width - this.padding - ((string.index - 1) * this.stepStrings)\r\n\r\n            this.context.lineWidth = 0.5\r\n            this.context.strokeText('X', x - 2.5, this.topPadding - 2)\r\n        }\r\n    }\r\n\r\n    drawLine(startX: number, startY: number, endX: number, endY: number) {\r\n\r\n        this.context.beginPath()\r\n\r\n        this.context.moveTo(startX, startY)\r\n        this.context.lineTo(endX, endY)\r\n        this.context.stroke()\r\n\r\n        this.context.beginPath()\r\n    }\r\n\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n        this.context.beginPath()\r\n    }\r\n}\r\n\r\nexport default ChordCanvas","import SnackbarsStore, { iSnackbar } from '../../stores/snackbar'\r\n\r\nexport const snackbar = (message: string, callback?: () => void) => {\r\n    return SnackbarsStore.showSnackbar({ message, callback })\r\n}","import { v4 as uuidv4 } from 'uuid'\r\n\r\nexport const createGuid = () => {\r\n    return uuidv4()\r\n}","export const stringsByCount = ['', 'Первая', 'Вторая', 'Третья', 'Четвертая', 'Пятая', 'Шестая']","export const notes = [\r\n    'C',\r\n    'C#',\r\n    'D',\r\n    'D#',\r\n    'E',\r\n    'F',\r\n    'F#',\r\n    'G',\r\n    'G#',\r\n    'A',\r\n    'A#',\r\n    'B'\r\n]","// Import the functions you need from the SDKs you need\r\nimport { initializeApp } from 'firebase/app'\r\nimport { getAnalytics } from 'firebase/analytics'\r\nimport { getDatabase } from 'firebase/database'\r\nimport { getFirestore, collection } from 'firebase/firestore'\r\n\r\n// TODO: Add SDKs for Firebase products that you want to use\r\n// https://firebase.google.com/docs/web/setup#available-libraries\r\n\r\n// Your web app's Firebase configuration\r\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAG70Q8XMvKfSU48NLjICNcHxm4w1LGGiU\",\r\n  authDomain: \"chords-test-c25b3.firebaseapp.com\",\r\n  projectId: \"chords-test-c25b3\",\r\n  storageBucket: \"chords-test-c25b3.appspot.com\",\r\n  messagingSenderId: \"961783308721\",\r\n  appId: \"1:961783308721:web:265426d5c87511d98add90\"\r\n};\r\n\r\nconst init = () => {\r\n\r\n    // Initialize Firebase\r\n    const app = initializeApp(firebaseConfig)\r\n    const analytics: string =null// = getAnalytics(app)\r\n    const database = getDatabase(app)\r\n    const firestore = getFirestore(app)\r\n\r\n    return { app, database, firestore, analytics }\r\n}\r\n\r\nexport default init","import React, { useMemo } from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { Checkbox } from '@vkontakte/vkui'\r\n\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nconst BarreField: React.FC = observer(() => {\r\n\r\n    return (\r\n        <Checkbox checked={Store.barre} onChange={event => Store.changeProperty('barre', !Store.barre)}>Баррэ</Checkbox>\r\n    )\r\n})\r\n\r\nexport default BarreField","import React, { useEffect, useRef, useMemo } from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { Div } from '@vkontakte/vkui'\r\n\r\nimport Store from '../../../../stores/add-chords-store'\r\nimport ChordCanvas from '../../../../code/canvas/chord'\r\n\r\nconst Fret: React.FC = observer(() => {\r\n\r\n    const canvas = useRef<HTMLCanvasElement>(null)\r\n    const params = Store.chordParams\r\n\r\n    const chordCanvasRef = useRef<ChordCanvas>()\r\n\r\n    useEffect(() => {\r\n        Store.canvas = chordCanvasRef.current = new ChordCanvas(canvas.current!)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n\r\n        const chordCanvas = chordCanvasRef.current!\r\n        chordCanvas.draw(params, params.instrument === 'ukulele' ? 90 : 110, 170)\r\n\r\n    }, [params])\r\n\r\n    console.log('rerender')\r\n\r\n    return (\r\n        <Div style={{display: 'flex', justifyContent: 'center'}}>\r\n            <canvas ref={canvas} width={110} height={170}/>\r\n        </Div> \r\n    )\r\n\r\n})\r\n\r\nexport default Fret","import React, { useMemo, forwardRef } from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { CustomSelectOption, FormItem, Select, SliderSwitch } from '@vkontakte/vkui'\r\n\r\nimport { stringsByCount } from '../../../../code/data/guitar-string'\r\n\r\ninterface iProps {\r\n    barre: boolean\r\n    startFret: number\r\n    fret: number | string\r\n    index: number\r\n    changeFret: (fret: string) => void\r\n}\r\n\r\nconst GuitarStringField: React.FC<iProps> = ({ fret, index, barre, startFret, changeFret }) => {\r\n           \r\n    const data = useMemo(() => {\r\n\r\n        const start = barre ? startFret + 1 : startFret\r\n\r\n        let data = [\r\n            { label: 'Не играется', value: 'notPlayed' },\r\n            { label: 'Открытая', value: startFret }\r\n        ]\r\n\r\n        for(let i = start + 1; i <= start + (barre ? 4 : 5); i++) {\r\n            data.push({ label: i.toString(), value: i })\r\n        }\r\n\r\n        return data\r\n        \r\n    }, [startFret, barre, fret])\r\n\r\n    if(!data.some(item => item.value === fret)) {\r\n        changeFret(data[1].value as any)\r\n    }\r\n\r\n    return (\r\n        \r\n        <FormItem top={`${stringsByCount[index]} струна`}>\r\n\r\n            <Select\r\n                value={fret}\r\n                options={data}\r\n                renderOption={({ option, ...restProps }) => (<CustomSelectOption {...restProps} />)}\r\n                onChange={event => changeFret(event.target.value)}\r\n            />\r\n\r\n        </FormItem>\r\n    )\r\n}\r\n\r\nexport default GuitarStringField","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { FormItem, SliderSwitch } from '@vkontakte/vkui'\r\n\r\nimport { MusicalInstrument } from '../../../../types/global-types'\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nimport String from './guitar-string'\r\n\r\n\r\nconst GuitarStringFields: React.FC = observer(() => {\r\n\r\n    return (\r\n\r\n        <>\r\n\r\n            {\r\n                Store.guitarStrings.map(string =>\r\n                    \r\n                    <String\r\n                        key={string.index}\r\n                        fret={string.fret}\r\n                        index={string.index}\r\n                        barre={Store.barre}\r\n                        startFret={Store.startFret}\r\n                        changeFret={(fret) => Store.changeString(string.index, fret)}\r\n                    />)\r\n            }\r\n\r\n        </>\r\n    )\r\n})\r\n\r\nexport default GuitarStringFields","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { CellButton, Group, Panel, PanelHeader, PanelHeaderClose, View, FormLayout, FormItem, SliderSwitch, Select, CustomSelectOption, PanelHeaderSubmit } from '@vkontakte/vkui'\r\n\r\nimport { notes } from '../../../code/data/notes'\r\n\r\nimport HeaderWithBack from '../../vk/layout/header/heade-and-back'\r\nimport Canvas from './drawing-fret'\r\nimport Instrument from './instrument'\r\nimport Notes from './notes'\r\nimport Name from './name'\r\nimport StartFret from './startFret'\r\nimport Barre from './barre'\r\nimport GuitarStrings from './guitar-strings'\r\nimport SaveButton from './save-button'\r\n\r\nconst AddChordsForm: React.FC = observer(() => {\r\n\r\n    return (\r\n        <FormLayout>\r\n      \r\n            <HeaderWithBack>\r\n                Добавить аккорд\r\n            </HeaderWithBack>\r\n\r\n            <Group>\r\n\r\n                <Instrument/>\r\n                <Notes />\r\n                <Name />\r\n\r\n                <Canvas />\r\n\r\n                <SaveButton />\r\n\r\n                <StartFret />\r\n                <Barre />\r\n                <GuitarStrings />\r\n                \r\n            </Group>\r\n\r\n        </FormLayout >\r\n    )\r\n})\r\n\r\nexport default AddChordsForm","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { FormItem, SliderSwitch } from '@vkontakte/vkui'\r\n\r\nimport { MusicalInstrument } from '../../../../types/global-types'\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nconst InstrumentField: React.FC = observer(() => {\r\n\r\n    return (\r\n        <FormItem top='Инструмент'>\r\n            <SliderSwitch\r\n                activeValue={Store.instrument}\r\n                onSwitch={ value => Store.changeInstrtument(value as MusicalInstrument)}\r\n                options={[\r\n                    {\r\n                        name: 'Гитара',\r\n                        value: 'guitar',\r\n                    },\r\n                    {\r\n                        name: 'Укулеле',\r\n                        value: 'ukulele',\r\n                    },\r\n                ]}\r\n            />\r\n        </FormItem>\r\n    )\r\n})\r\n\r\nexport default InstrumentField","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { FormItem, Select, CustomSelectOption, Input } from '@vkontakte/vkui'\r\n\r\nimport { notes } from '../../../../code/data/notes'\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nconst NameField: React.FC = observer(() => {\r\n\r\n    return (\r\n \r\n        <FormItem top='Название'>\r\n            <Input value={Store.name} onChange={event => Store.changeProperty('name', event.target.value)} />\r\n        </FormItem>\r\n    )\r\n}) \r\n\r\nexport default NameField","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { FormItem, Select, CustomSelectOption } from '@vkontakte/vkui'\r\n\r\nimport { notes } from '../../../../code/data/notes'\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nconst NotesField: React.FC = observer(() => {\r\n\r\n    return (\r\n\r\n        <FormItem top='Нота'>\r\n\r\n            <Select\r\n                value={Store.note}\r\n                options={notes.map(note => ({ label: note, value: note }))}\r\n                renderOption={({ option, ...restProps }) => (<CustomSelectOption {...restProps} />)}\r\n                onChange={event => Store.changeNote(event.target.value)}\r\n            />\r\n\r\n        </FormItem>\r\n    )\r\n})\r\n\r\nexport default NotesField","import React, { useMemo } from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { FormItem, Select, CustomSelectOption, CellButton  } from '@vkontakte/vkui'\r\n\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nconst SaveButton: React.FC = observer(() => {\r\n\r\n    return (\r\n\r\n        <CellButton centered onClick={Store.saveChord}> \r\n                Сохранить аккорд\r\n        </CellButton>\r\n    )\r\n})\r\n\r\nexport default SaveButton","import React, { useMemo } from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { FormItem, Select, CustomSelectOption } from '@vkontakte/vkui'\r\n\r\nimport Store from '../../../../stores/add-chords-store'\r\n\r\nconst StartFretField: React.FC = observer(() => {\r\n\r\n    const fretsData = useMemo(() => {\r\n\r\n        let frets = []\r\n\r\n        for(let i = 0; i <= 8; i++) {\r\n            frets.push(i)\r\n        }\r\n\r\n        return frets\r\n\r\n    }, [])\r\n\r\n    return (\r\n\r\n        <FormItem top={`Начальный лад`}>\r\n\r\n            <Select\r\n                value={Store.startFret}\r\n                options={fretsData.map(fret => ({ label: fret.toString(), value: fret }))}\r\n                renderOption={({ option, ...restProps }) => (<CustomSelectOption {...restProps} />)}\r\n                onChange={event => Store.changeProperty('startFret', +event.target.value)}\r\n            />\r\n \r\n        </FormItem>\r\n    )\r\n})\r\n\r\nexport default StartFretField","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\n\r\nimport Store from '../../../../stores/snackbar'\r\nimport { Snackbar } from '@vkontakte/vkui'\r\n\r\nconst SnackbarContainer: React.FC = observer(() => {\r\n    \r\n    const current = Store.currentSnackbar\r\n    if(!current) return null\r\n\r\n    return (\r\n        <Snackbar\r\n        onClose={current.close}\r\n      >\r\n        {current.message}\r\n      </Snackbar>\r\n    )\r\n})\r\n\r\nexport default SnackbarContainer","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { Epic, PanelHeader, SplitCol, SplitLayout, useAdaptivity, usePlatform, ViewWidth, VKCOM } from '@vkontakte/vkui'\r\n\r\nimport GlobalStore from '../../stores/global-store'\r\n\r\nimport DesktopNav from '../navigation/desktop'\r\nimport MobileNav from '../navigation/mobile'\r\n\r\ninterface iProps {\r\n    children: JSX.Element[]\r\n}\r\n\r\nconst Layout: React.FC = observer(({ children }) => {\r\n\r\n    const platform = usePlatform();\r\n    const hasHeader = platform !== VKCOM;\r\n\r\n    return (\r\n\r\n        <SplitLayout\r\n            header={hasHeader && <PanelHeader separator={false} />}\r\n            style={{ justifyContent: \"center\" }}\r\n        >\r\n            \r\n            <SplitCol\r\n                width={'100%'}\r\n                maxWidth={'100%'}\r\n            >\r\n                \r\n                    {children}\r\n                \r\n            </SplitCol>\r\n        </SplitLayout>\r\n\r\n    )\r\n})\r\n\r\nexport default Layout","import React from 'react'\r\nimport { Tabbar, TabbarItem } from '@vkontakte/vkui'\r\nimport { observer } from 'mobx-react-lite'\r\n\r\nimport isDesktopHook from '../../../hooks/isDesktop'\r\nimport GlobalStore from '../../../stores/global-store'\r\n\r\nimport { pages } from '../../../pages'\r\n\r\nconst MobileNav: React.FC = observer(() => {\r\n\r\n    return (\r\n        <Tabbar>\r\n\r\n            {\r\n                pages.map(page => \r\n\r\n                    <TabbarItem\r\n                        key={page.key}\r\n                        onClick={() => GlobalStore.setActiveStory(page.key)}\r\n                        selected={GlobalStore.activeStory === page.key}\r\n                        data-story={page.key}\r\n                        text={page.name}\r\n                    >\r\n                        {page.iconComponent}\r\n                    </TabbarItem>\r\n                )\r\n            }\r\n\r\n        </Tabbar>\r\n    )\r\n})\r\n\r\nexport default MobileNav\r\n\r\n","import React from 'react'\r\nimport { Panel, PanelHeader, View } from '@vkontakte/vkui'\r\n\r\nconst AddTrackView: React.FC = () => {\r\n\r\n    return (\r\n      <>\r\n\r\n        <PanelHeader>Добавить трек</PanelHeader>\r\n\r\n        \r\n      </>\r\n    )\r\n\r\n}\r\n\r\nexport default AddTrackView","import React from 'react'\r\n\r\nimport AddChordsForm from '../../../chords/add-chord'\r\nimport Snackbar from '../../../common/dialogs/snackbar'\r\n\r\nconst AddChordsView: React.FC = () => {\r\n\r\n    return (\r\n        <>\r\n        <AddChordsForm />\r\n        <Snackbar />\r\n        </>\r\n    )\r\n}\r\n\r\nexport default AddChordsView","import React from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { CellButton, Group, Panel, PanelHeader, View } from '@vkontakte/vkui'\r\nimport GlobalStore from '../../../stores/global-store'\r\n\r\n\r\nconst AdminView: React.FC = observer(() => {\r\n\r\n    return (\r\n        <>\r\n            <PanelHeader>Администрирование</PanelHeader>\r\n\r\n            <Group>\r\n            \r\n            <CellButton onClick={ () => GlobalStore.setActivePanel('addChords') }>\r\n                Добавить аккорд\r\n            </CellButton>\r\n        \r\n            </Group>\r\n\r\n        </>\r\n    )\r\n})\r\n\r\nexport default AdminView","import { Panel, PanelHeader, View } from '@vkontakte/vkui'\r\nimport React from 'react'\r\n\r\nconst ChordsView: React.FC = () => {\r\n\r\n    return (\r\n        <>\r\n            <PanelHeader>Аккорды</PanelHeader>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default ChordsView","import { Panel, PanelHeader, View } from '@vkontakte/vkui'\r\nimport React from 'react'\r\n\r\nconst FavouritesView: React.FC = () => {\r\n\r\n    return (\r\n        <>\r\n            <PanelHeader>Администрирование</PanelHeader>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default FavouritesView","import { Panel, View, PanelHeader } from '@vkontakte/vkui'\r\nimport React from 'react'\r\n\r\nconst TracksView: React.FC = (props) => {\r\n\r\n    return (\r\n        <>\r\n            <PanelHeader>Треки</PanelHeader>\r\n\r\n            tracks\r\n        </>   \r\n    )  \r\n}\r\n\r\nexport default TracksView","import React from 'react'\r\nimport { Icon28ClipOutline, Icon28MessageOutline, Icon28ServicesOutline, Icon28UserCircleOutline, Icon56NewsfeedOutline } from '@vkontakte/icons'\r\nimport { Epic, Group, Panel, PanelHeader, PanelHeaderBack, Placeholder, Root, View } from '@vkontakte/vkui'\r\n\r\nimport { observer } from 'mobx-react-lite'\r\nimport GlobalStore from '../../stores/global-store'\r\n\r\nimport Tracks from './tracks'\r\nimport Chords from './chords'\r\nimport Favourites from './favourites'\r\nimport AddTrack from './add-track'\r\nimport Admin from './admin'\r\nimport AdminAddChords from './admin/add-chords'\r\n\r\nimport MobileNav from '../navigation/mobile'\r\n\r\nconst ViewList: React.FC = observer(() => {\r\n\r\n  return (\r\n\r\n    <Epic activeStory={GlobalStore.activeStory} tabbar={<MobileNav />}>\r\n\r\n      <View id='tracks' activePanel={GlobalStore.activePanel}>\r\n        <Panel id='tracks'>\r\n          <Tracks />\r\n        </Panel>\r\n      </View >\r\n\r\n      <View id='chords' activePanel={GlobalStore.activePanel}>\r\n        <Panel id='chords'>\r\n          <Chords />\r\n        </Panel>\r\n      </View >\r\n\r\n      <View id='favourites' activePanel={GlobalStore.activePanel}>\r\n        <Panel id='favourites'>\r\n          <Favourites />\r\n        </Panel>\r\n      </View >\r\n\r\n      <View id='addTrack' activePanel={GlobalStore.activePanel}>\r\n        <Panel id='addTrack'>\r\n          <AddTrack />\r\n        </Panel>\r\n      </View >\r\n\r\n      <View id='admin' activePanel={GlobalStore.activePanel}>\r\n        <Panel id='admin'>\r\n          <Admin />\r\n        </Panel>\r\n        <Panel id='addChords'>\r\n          <AdminAddChords />\r\n        </Panel>\r\n      </View >\r\n\r\n    </Epic>\r\n  )\r\n})\r\n\r\nexport default ViewList","import React, { Children } from 'react'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { PanelHeader, PanelHeaderClose, PanelHeaderProps } from '@vkontakte/vkui'\r\n\r\nimport GlobalStore from '../../../../../stores/global-store'\r\n\r\n\r\nconst HeaderWithBack: React.FC<PanelHeaderProps> = observer((props) => {\r\n\r\n    return (\r\n        <PanelHeader\r\n            left={<PanelHeaderClose onClick={() => GlobalStore.toMainPanel() }/>}\r\n            {...props}\r\n        >\r\n           {props.children}\r\n        </PanelHeader> \r\n    )\r\n})\r\n\r\nexport default HeaderWithBack","import React from 'react'\r\nimport { Icon28PlaylistOutline, Icon28MusicOutline, Icon28FavoriteOutline, Icon28AddSquareOutline, Icon28SettingsOutline } from '@vkontakte/icons'\r\nimport { JsxElement } from 'typescript'\r\n\r\nexport type iPageKey = 'tracks' | 'chords' | 'favourites' | 'addTrack' | 'admin'\r\n\r\nexport interface iPage {\r\n  key: iPageKey\r\n  name: string\r\n  iconComponent: JSX.Element\r\n}\r\n\r\nexport const pages: iPage[] = [\r\n    {\r\n        key: 'tracks',\r\n        name: 'Треки',\r\n        iconComponent: <Icon28PlaylistOutline />\r\n    },\r\n    {\r\n      key: 'chords',\r\n      name: 'Аккорды',\r\n      iconComponent: <Icon28MusicOutline />\r\n    },\r\n    {\r\n      key: 'favourites',\r\n      name: 'Избранное',\r\n      iconComponent: <Icon28FavoriteOutline />\r\n    },\r\n    {\r\n      key: 'addTrack',\r\n      name: 'Добавить трек',\r\n      iconComponent: <Icon28AddSquareOutline />\r\n    },\r\n    {\r\n      key: 'admin',\r\n      name: 'Администрирование',\r\n      iconComponent: <Icon28SettingsOutline />\r\n    }\r\n]\r\n\r\n","import express from 'express'\r\nimport useragent from 'express-useragent'\r\nimport database from './server/database'\r\nimport validateVK from './server/vk'\r\nimport fireBaseToken from './server/auth'\r\n\r\nglobal['window'] = {}\r\n\r\nimport getApp from './ssr'\r\n\r\nconst app = express()\r\napp.use(useragent.express())\r\n\r\ndatabase.init()\r\n\r\napp.get(/\\.(js|css|map|ico)$/, express.static(__dirname))\r\napp.use('*', async (req, res) => {\r\n\r\n    global['window'] = {}\r\n\r\n    const isValidVk = validateVK(req)\r\n    const adminToken = isValidVk ? await fireBaseToken(req) : null\r\n\r\n    const html = getApp(req['useragent'].source, isValidVk, adminToken)\r\n    \r\n    res.contentType('text/html')\r\n    res.status(200)\r\n\r\n    return res.send(html)\r\n})\r\n\r\napp.listen('9000', () => {\r\n    console.log('Сервер на порту 9000')\r\n})","import { async } from '@firebase/util'\r\nimport { firestore, auth } from 'firebase-admin'\r\nimport { isDev } from './common'\r\nimport database from './database'\r\n\r\nconst createFirebaseToken = async (req) => {\r\n\r\n    const query = req.query \r\n    const vkId = !isDev ? (query && query.vk_user_id) : '222834864'\r\n    if(!vkId) return\r\n\r\n    const store = firestore(database.app)\r\n    const isAdmin = !(await store.collection('admins').where('vkId', '==', +vkId).get()).empty\r\n    if(!isAdmin) return\r\n\r\n    return await database.app.auth().createCustomToken(vkId)\r\n}\r\n\r\nexport default createFirebaseToken","export const isDev = process.env.NODE_ENV === 'development'","import admin, { auth } from 'firebase-admin'\r\nimport fs from 'fs'\r\nimport { resolve } from 'path'\r\n\r\nclass Database {\r\n\r\n    app: admin.app.App\r\n\r\n    init() {\r\n        const config = JSON.parse(fs.readFileSync(resolve(__dirname, '..', 'private/service-account-key.json')).toString('utf8'))\r\n        this.app = admin.initializeApp({\r\n            credential: admin.credential.cert(config),\r\n            databaseURL: \"https://chords-7f150.firebaseio.com\"\r\n          })\r\n        this.app.auth()\r\n    }\r\n}\r\n\r\nconst database = new Database()\r\nexport default database","import crypto from 'crypto'\r\nimport fs from 'fs'\r\nimport { isDev } from './common'\r\nimport { resolve } from 'path'\r\n\r\nconst config = JSON.parse(fs.readFileSync(resolve(__dirname, '..', 'private/vk-secret-key.json')).toString('utf8'))\r\n\r\nconst validateVkParams = (req) => {\r\n\r\n    if(isDev) return true\r\n\r\n    const query = req.query\r\n    let vkParams = []\r\n\r\n    const sign: string = query.sign\r\n\r\n    if(!sign) return false\r\n\r\n    for(let key in query) {\r\n\r\n        if(key.startsWith('vk_')) {\r\n            vkParams.push(`${key}=${query[key]}`)\r\n        }\r\n    }\r\n\r\n    const vkParamsString = vkParams.join('&')\r\n\r\n    const paramsHash = crypto\r\n    .createHmac('sha256', config.secret)\r\n    .update(vkParamsString)\r\n    .digest()\r\n    .toString('base64')\r\n    .replace(/\\+/g, '-')\r\n    .replace(/\\//g, '_')\r\n    .replace(/=$/, '')\r\n\r\n    return paramsHash === sign\r\n}\r\n\r\nexport default validateVkParams","import React from 'react'\r\nimport { renderToString } from 'react-dom/server'\r\nimport { SSRWrapper } from '@vkontakte/vkui'\r\n\r\nimport App from './app'\r\n\r\nexport default (userAgent, validVk, adminToken) => {\r\n\r\n    const jsx = <SSRWrapper userAgent={userAgent}>\r\n        <App/>\r\n    </SSRWrapper>\r\n    const reactHtml = renderToString(jsx)\r\n\r\n    return getHtml(reactHtml, { validVk, adminToken })\r\n}\r\n\r\nconst getHtml = (reactHtml, data) => {\r\n\r\n    return `\r\n    <!DOCTYPE html>\r\n    <html lang=\"en\">\r\n    <head>\r\n        <meta charset=\"UTF-8\">\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\r\n        <link rel=\"shortcut icon\" type=\"image/png\" href=\"/images/favicon.jpg\">\r\n        <title>Аккорды</title>\r\n        <link href=\"/main.css\" rel=\"stylesheet\">\r\n    </head>\r\n    <body>\r\n        <script>\r\n        debugger;\r\n            window['adminToken'] = '${data.adminToken}';\r\n            window['validVk'] = ${data.validVk};\r\n        </script>\r\n\r\n        <div id=\"root\" class=\"vkui__root\">${reactHtml}</div> \r\n        <script src=\"/main.js\"></script>\r\n    </body>\r\n    </html>\r\n    `\r\n}","import { makeAutoObservable } from 'mobx'\r\nimport { iPageKey, pages } from '../pages'\r\nimport { MusicalInstrument } from '../types/global-types'\r\nimport { notes } from '../code/data/notes'\r\n\r\nimport ChordCanvas from '../code/canvas/chord'\r\nimport GlobalStore from './global-store'\r\nimport { collection, addDoc } from '@firebase/firestore'\r\nimport { snackbar } from '../code/common/alerts'\r\n\r\ntype Mode = 'add' | 'edit'\r\n\r\nexport interface iParams {\r\n    mode: Mode\r\n    instrument: MusicalInstrument\r\n    note: string\r\n    name: string\r\n    startFret: number\r\n    barre: boolean\r\n    guitarStrings: iGuitarString[]\r\n}\r\n\r\nexport interface iGuitarString {\r\n    index: number,\r\n    fret: number | string\r\n}\r\n\r\nconst defauiltParams: iParams = {\r\n    mode: 'add',\r\n    instrument: 'guitar',\r\n    note: notes[0],\r\n    name: notes[0],\r\n    startFret: 0,\r\n    barre: false,\r\n    guitarStrings: []\r\n}\r\n\r\nexport class AddChordsStore implements iParams {\r\n\r\n    mode: Mode\r\n    instrument: MusicalInstrument\r\n    note: string \r\n    name: string\r\n    startFret: number\r\n    barre: boolean\r\n\r\n    canvas: ChordCanvas\r\n\r\n    guitarStrings!: iGuitarString[]\r\n\r\n    constructor(params: iParams = defauiltParams) {\r\n\r\n        this.fillParams(params)\r\n        makeAutoObservable(this, undefined, { deep: true })\r\n\r\n        this.saveChord = this.saveChord.bind(this)\r\n    }\r\n\r\n    fillParams(params: iParams) {\r\n\r\n        for (let prop in params) {\r\n            this[prop as keyof this] = params[prop as keyof iParams] as any\r\n        }\r\n\r\n        if (!this.guitarStrings.length) {\r\n            this.fillStrings()\r\n        }\r\n    }\r\n\r\n    changeProperty(property: keyof iParams, value: any) {\r\n        this[property as keyof this] = value\r\n    }\r\n\r\n    changeNote(note: string) {\r\n        this.note = note\r\n        this.name = this.note\r\n    }\r\n\r\n    changeString(index: number, fret: string) {\r\n\r\n        const string = this.guitarStrings.find(string => string.index === index)\r\n\r\n        if (string) {\r\n            string.fret = isNaN(fret as any) ? fret : +fret\r\n        }\r\n\r\n        this.guitarStrings = [...this.guitarStrings]\r\n    }\r\n\r\n    changeInstrtument(instrument: MusicalInstrument) {\r\n        this.instrument = instrument\r\n        this.fillStrings()\r\n    }\r\n\r\n    fillStrings() {\r\n\r\n        const guitarStringsCount = this.instrument === 'guitar' ? 6 : 4\r\n        this.guitarStrings = []\r\n\r\n        for (let i = 1; i <= guitarStringsCount; i++) {\r\n            this.guitarStrings.push({ index: i, fret: 0 })\r\n        }\r\n    }\r\n\r\n    async saveChord() {\r\n        \r\n        const firestore = GlobalStore.firestore\r\n\r\n        const result = await addDoc(collection(firestore, `chords/${this.note}/${this.name}`), this.chordParams)\r\n        console.log(result)\r\n        \r\n        snackbar('Добавили аккорд')\r\n        this.fillParams(defauiltParams) \r\n    }\r\n\r\n    get chordParams(): iParams {\r\n\r\n        const params: iParams = {\r\n            mode: this.mode,\r\n            instrument: this.instrument,\r\n            note: this.note,\r\n            name: this.name,\r\n            startFret: this.startFret,\r\n            barre: this.barre,\r\n            guitarStrings: [...this.guitarStrings]\r\n        }\r\n\r\n        return params\r\n    }\r\n}\r\n\r\nconst store = new AddChordsStore()\r\nexport default store","import { makeAutoObservable, makeObservable, observable } from 'mobx'\r\nimport { FirebaseApp } from 'firebase/app'\r\nimport { Analytics } from 'firebase/analytics'\r\nimport initDatabase from '../code/firebase'\r\nimport { iPageKey, pages } from '../pages'\r\nimport { Database, getDatabase } from 'firebase/database'\r\nimport { Firestore } from '@firebase/firestore'\r\n\r\nexport class GlobalStore {\r\n\r\n    activeStory: iPageKey = pages[0].key\r\n    activePanel: string = pages[0].key\r\n\r\n    firebase: FirebaseApp\r\n    database: Database\r\n    firestore: Firestore\r\n    firebaseAnalitics: Analytics\r\n\r\n    adminToken: string\r\n    validVk: boolean\r\n\r\n    constructor() {\r\n\r\n        const { app, database, firestore, analytics } = initDatabase()\r\n\r\n        this.firebase = app\r\n        this.database = database\r\n        this.firestore = firestore\r\n\r\n        //this.firebaseAnalitics = analytics\r\n\r\n        this.adminToken = global['window'] && global['window'].adminToken\r\n        this.validVk = global['window'] && global['window'].validVk   \r\n        \r\n        debugger\r\n\r\n        makeObservable(this, {\r\n            activeStory: observable,\r\n            activePanel: observable\r\n        })\r\n    }    \r\n\r\n    toMainPanel() {\r\n        this.activePanel = this.activeStory\r\n    }\r\n\r\n    setActiveStory(activeStory: iPageKey, panel: string = '') {\r\n        this.activeStory = activeStory\r\n        this.activePanel = panel || activeStory\r\n    }\r\n\r\n    setActivePanel(panel: string = '') {\r\n        this.activePanel = panel\r\n    }\r\n}\r\n  \r\nvar globalStore =  new GlobalStore()  \r\nexport default globalStore","import { makeAutoObservable, observable } from 'mobx'\r\nimport { createGuid } from '../code/common/guid'\r\n\r\nexport class SnackbarsStore {\r\n\r\n    private snackbars: iShowedSnackbar[] = []\r\n    \r\n    get currentSnackbar(): iShowedSnackbar {\r\n        return this.snackbars[0]\r\n    }\r\n\r\n    constructor() {\r\n        makeAutoObservable(this)\r\n    }\r\n\r\n    showSnackbar(snackbar: iSnackbar) {\r\n\r\n        const id = createGuid()\r\n\r\n        const close = () => {\r\n\r\n            if(snackbar.callback) {\r\n                snackbar.callback()\r\n            }\r\n\r\n            this.closeSnackbar(id)\r\n        }\r\n\r\n        const _snackbar: iShowedSnackbar = { \r\n            ...snackbar, \r\n            id,\r\n            close\r\n         }\r\n         \r\n        this.snackbars = [...this.snackbars, _snackbar]\r\n\r\n        return _snackbar\r\n    }\r\n\r\n    closeSnackbar(id: string) {\r\n        this.snackbars = this.snackbars.filter(snackbar => snackbar.id !== id)\r\n    }\r\n}\r\n  \r\nexport interface iSnackbar {\r\n    message: string\r\n    callback?: () => void\r\n}\r\n\r\nexport interface iShowedSnackbar extends iSnackbar {\r\n    id: string\r\n    close: () => void\r\n}\r\n\r\nconst store = new SnackbarsStore()\r\nexport default store","","module.exports = require(\"@firebase/firestore\");","module.exports = require(\"@vkontakte/icons\");","module.exports = require(\"@vkontakte/vkui\");","module.exports = require(\"crypto\");","module.exports = require(\"express\");","module.exports = require(\"express-useragent\");","module.exports = require(\"firebase-admin\");","module.exports = require(\"firebase/app\");","module.exports = require(\"firebase/database\");","module.exports = require(\"firebase/firestore\");","module.exports = require(\"mobx\");","module.exports = require(\"mobx-react-lite\");","module.exports = require(\"react\");","module.exports = require(\"react-dom/server\");","module.exports = require(\"uuid\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/server.ts\");\n",""],"names":["React","AppRoot","AdaptivityProvider","ConfigProvider","Layout","ViewList","console","log","window","err","global","isServer","App","ChordCanvas","constructor","canvas","padding","context","getContext","draw","params","width","height","clear","drawEmptyFrets","strokeStyle","stringsColor","lineWidth","drawFrets","drawStrings","drawChords","drawDescription","y","topPadding","stepFrets","i","drawLine","x","stepStrings","guitarStrings","length","forEach","string","fretsColor","drawBarre","drawStringFrets","barre","strings","skipStrings","fret","startX","endX","startFret","fert","index","beginPath","fillStyle","arc","Math","PI","fill","strokeText","toString","startY","endY","moveTo","lineTo","stroke","clearRect","SnackbarsStore","snackbar","message","callback","showSnackbar","v4","uuidv4","createGuid","stringsByCount","notes","initializeApp","getDatabase","getFirestore","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","init","app","analytics","database","firestore","observer","Checkbox","Store","BarreField","event","changeProperty","useEffect","useRef","Div","Fret","chordParams","chordCanvasRef","current","chordCanvas","instrument","display","justifyContent","useMemo","CustomSelectOption","FormItem","Select","GuitarStringField","changeFret","data","start","label","value","push","some","item","option","restProps","target","String","GuitarStringFields","map","changeString","Group","FormLayout","HeaderWithBack","Canvas","Instrument","Notes","Name","StartFret","Barre","GuitarStrings","SaveButton","AddChordsForm","SliderSwitch","InstrumentField","changeInstrtument","name","Input","NameField","NotesField","note","changeNote","CellButton","saveChord","StartFretField","fretsData","frets","Snackbar","SnackbarContainer","currentSnackbar","close","PanelHeader","SplitCol","SplitLayout","usePlatform","VKCOM","children","platform","hasHeader","Tabbar","TabbarItem","GlobalStore","pages","MobileNav","page","key","setActiveStory","activeStory","iconComponent","AddTrackView","AddChordsView","AdminView","setActivePanel","ChordsView","FavouritesView","TracksView","props","Epic","Panel","View","Tracks","Chords","Favourites","AddTrack","Admin","AdminAddChords","activePanel","PanelHeaderClose","toMainPanel","Icon28PlaylistOutline","Icon28MusicOutline","Icon28FavoriteOutline","Icon28AddSquareOutline","Icon28SettingsOutline","express","useragent","validateVK","fireBaseToken","getApp","use","get","static","__dirname","req","res","isValidVk","adminToken","html","source","contentType","status","send","listen","isDev","createFirebaseToken","query","vkId","vk_user_id","store","isAdmin","collection","where","empty","auth","createCustomToken","process","env","NODE_ENV","admin","fs","resolve","Database","config","JSON","parse","readFileSync","credential","cert","databaseURL","crypto","validateVkParams","vkParams","sign","startsWith","vkParamsString","join","paramsHash","createHmac","secret","update","digest","replace","renderToString","SSRWrapper","userAgent","validVk","jsx","reactHtml","getHtml","makeAutoObservable","addDoc","defauiltParams","mode","AddChordsStore","fillParams","undefined","deep","bind","prop","fillStrings","property","find","isNaN","guitarStringsCount","result","makeObservable","observable","initDatabase","firebase","panel","globalStore","snackbars","id","closeSnackbar","_snackbar","filter"],"sourceRoot":""}